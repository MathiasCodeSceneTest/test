<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Kirby Chart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
</head>
<body style="margin: 0; padding: 0;">
  <div id="chart"></div>
  <script src="nativescript-webview-interface.js"></script>
  <script src="highcharts.js"></script>
  <script>
    (function () {
        var oWebViewInterface = window.nsWebViewInterface;

        function addNativeMsgListener() {
            oWebViewInterface.on('updateChart', function (chartData) {
                configureChartOptions(chartData);
                var chart = Highcharts.chart('chart', chartData.options);
            });
        }

        function configureChartOptions(chartData) {
            chartData.options.chart.height = chartData.height;
            if (chartData.options.chart.type === 'pie') {
                chartData.options.plotOptions.pie.point.events.legendItemClick = function(e) {
                    return e.preventDefault();
                }
            } else if (chartData.options.chart.type === 'areaspline') {
                chartData.options.tooltip.formatter = function(e) {
                    return '<div style=\'margin-top: 6px;\'>' + this.y + '</div>';
                }
            }
        }

        function init() {
            addNativeMsgListener();
        }

        init();
    })();
  </script>      
</body>
</html>
