@use '~@kirbydesign/core/src/scss/utils';
@use '~@kirbydesign/core/src/scss/interaction-state';
@use './form-field-inputs.shared' as shared;

:host.with-input {
  .input-wrapper {
    display: flex;
    @include interaction-state.apply-focus-visible($shadow: utils.get-elevation(2));

    background-color: utils.get-color('white');
    color: utils.get-color('white-contrast');
    border: none;
    box-sizing: border-box;
    font-family: shared.$form-field-input-font-family;

    // `font-size` should be declared in `em` units but to simplify the solution
    // to https://github.com/kirbydesign/designsystem/issues/2301 we're using `rem`.
    // Must be fixed by https://github.com/kirbydesign/designsystem/issues/2313
    font-size: 1rem;
    line-height: shared.$form-field-input-line-height;
    outline: none;
    margin: 0;
    appearance: none;
    border-radius: utils.size('s');
    box-shadow: utils.get-elevation(2);
    padding: 0 shared.$form-field-input-padding;
    width: 100%;
  }
  &.error {
    .input-wrapper {
      border: 1px solid utils.get-color('danger');
      padding: 0 calc(#{shared.$form-field-input-padding} - 1px); // subtract border width from padding to maintain overall height
    }
  }
  .prefix,
  .suffix {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .prefix ::ng-deep > * {
    padding-right: shared.$form-field-affix-padding;
  }
  .suffix ::ng-deep > * {
    padding-left: shared.$form-field-affix-padding;
  }
  &.disabled {
    .input-wrapper {
      background-color: utils.get-color('light-tint');
      color: utils.get-text-color('semi-dark');
      box-shadow: none;
    }
  }
  ::ng-deep input {
    border-radius: 0;
    box-shadow: none;
    padding-inline: 0;
    width: auto;
    border: none;
    flex-grow: 1;
    padding-top: shared.$form-field-input-padding;
    padding-bottom: shared.$form-field-input-padding;
  }
}

:host {
  display: block;
  position: relative; // Ensures correct position of cloned child input when Ionic scrollAssist is enabled
  margin-bottom: utils.size('s');
}
:host-context(kirby-item) {
  margin-bottom: 0;
}

.texts {
  display: flex;
  justify-content: space-between;
  padding: 2px utils.size('s') 0 utils.size('s');

  .message {
    flex: 75%;

    &:only-child {
      flex-basis: auto;
    }
  }

  .counter {
    flex: 25%;
    text-align: right;
  }
}

label {
  display: block;
}

.text {
  display: block;
  font-size: utils.font-size('s');
  font-weight: utils.font-weight('light');
  line-height: utils.line-height('s');
  margin-bottom: utils.size('xxxs');
  padding: 0 utils.size('s');
}
