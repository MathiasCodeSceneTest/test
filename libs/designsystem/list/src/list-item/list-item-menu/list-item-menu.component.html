<div [ngClass]="boundaryClass" class="menu-item" [class.selected]="isSelected">
  <ng-container *ngTemplateOutlet="itemTemplate; context: { $implicit: item }"></ng-container>
  <ng-container [ngSwitch]="swipeActions.length > 1">
    <ng-container *ngSwitchCase="true">
      <ng-container
        slot="end"
        *ngTemplateOutlet="menuTemplate; context: { $implicit: item }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="false">
      <ng-container
        slot="end"
        *ngTemplateOutlet="singleActionTemplate; context: { $implicit: swipeActions[0] }"
      ></ng-container>
    </ng-container>
  </ng-container>
</div>

<ng-template #menuTemplate let-item>
  <kirby-menu
    class="menu-action"
    [portalOutletConfig]="portalOutletConfig"
    [placement]="'bottom-end'"
    slot="end"
  >
    <button kirby-button type="button" [noDecoration]="true">
      <kirby-icon [name]="'more'"></kirby-icon>
    </button>
    <kirby-item
      [selectable]="true"
      *ngFor="let action of swipeActions; let i = index"
      (click)="_onSwipeActionSelect(action, item, $event)"
    >
      <div class="item-content">
        <label>{{ action | getActionTitle: [item] }}</label>
      </div>
    </kirby-item>
  </kirby-menu>
</ng-template>

<ng-template #singleActionTemplate let-action>
  <button kirby-button type="button" [noDecoration]="true">
    <kirby-icon name="{{ action?.icon }}"></kirby-icon>
  </button>
</ng-template>
